{% extends 'board/base.html' %}

{% block title %}{{ page_title }} - NestOn{% endblock %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <h1 class="page-title">âš™ï¸ {{ page_title }}</h1>
        <p class="page-subtitle">{{ page_subtitle }}</p>
    </div>
    
    <div class="page-content">
        <div class="interests-container">
            <!-- í˜„ì¬ ì„¤ì •ëœ ê´€ì‹¬ì‚¬ -->
            <div class="current-interests">
                <h3>í˜„ì¬ ì„¤ì •ëœ ê´€ì‹¬ì‚¬</h3>
                <div class="current-list">
                    <div class="interest-item active">
                        <div class="interest-icon">ğŸ­</div>
                        <div class="interest-name">ë¬¸í™”/ì˜ˆìˆ </div>
                        <button class="remove-btn" onclick="removeInterest('ë¬¸í™”/ì˜ˆìˆ ')">ì œê±°</button>
                    </div>
                    <div class="interest-item active">
                        <div class="interest-icon">ğŸƒâ€â™‚ï¸</div>
                        <div class="interest-name">ì²´ìœ¡/ìš´ë™</div>
                        <button class="remove-btn" onclick="removeInterest('ì²´ìœ¡/ìš´ë™')">ì œê±°</button>
                    </div>
                    <div class="interest-item active">
                        <div class="interest-icon">ğŸ½ï¸</div>
                        <div class="interest-name">ìŒì‹/ë§›ì§‘</div>
                        <button class="remove-btn" onclick="removeInterest('ìŒì‹/ë§›ì§‘')">ì œê±°</button>
                    </div>
                    <div class="interest-item active">
                        <div class="interest-icon">ğŸ›ï¸</div>
                        <div class="interest-name">ì‡¼í•‘/ìƒê¶Œ</div>
                        <button class="remove-btn" onclick="removeInterest('ì‡¼í•‘/ìƒê¶Œ')">ì œê±°</button>
                    </div>
                </div>
            </div>
            
            <!-- ê´€ì‹¬ì‚¬ ì¶”ê°€ -->
            <div class="add-interests">
                <h3>ê´€ì‹¬ì‚¬ ì¶”ê°€</h3>
                <div class="available-interests">
                    <div class="interest-item inactive" onclick="addInterest('ë¯¸ìˆ /ë””ìì¸', 'ğŸ¨')">
                        <div class="interest-icon">ğŸ¨</div>
                        <div class="interest-name">ë¯¸ìˆ /ë””ìì¸</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('ìŒì•…/ê³µì—°', 'ğŸµ')">
                        <div class="interest-icon">ğŸµ</div>
                        <div class="interest-name">ìŒì•…/ê³µì—°</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('ìŠ¤í¬ì¸ ', 'âš½')">
                        <div class="interest-icon">âš½</div>
                        <div class="interest-name">ìŠ¤í¬ì¸ </div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('ê±´ê°•/ì˜ë£Œ', 'ğŸ¥')">
                        <div class="interest-icon">ğŸ¥</div>
                        <div class="interest-name">ê±´ê°•/ì˜ë£Œ</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('êµìœ¡/ê°•ì—°', 'ğŸ“')">
                        <div class="interest-icon">ğŸ“</div>
                        <div class="interest-name">êµìœ¡/ê°•ì—°</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('í™˜ê²½/ìƒíƒœ', 'ğŸŒ±')">
                        <div class="interest-icon">ğŸŒ±</div>
                        <div class="interest-name">í™˜ê²½/ìƒíƒœ</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('ê¸°ìˆ /IT', 'ğŸ’»')">
                        <div class="interest-icon">ğŸ’»</div>
                        <div class="interest-name">ê¸°ìˆ /IT</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                    <div class="interest-item inactive" onclick="addInterest('ì—¬í–‰/ë ˆì €', 'âœˆï¸')">
                        <div class="interest-icon">âœˆï¸</div>
                        <div class="interest-name">ì—¬í–‰/ë ˆì €</div>
                        <button class="add-btn">ì¶”ê°€</button>
                    </div>
                </div>
            </div>
            
            <!-- ê´€ì‹¬ì‚¬ ìš°ì„ ìˆœìœ„ ì„¤ì • -->
            <div class="priority-settings">
                <h3>ê´€ì‹¬ì‚¬ ìš°ì„ ìˆœìœ„ ì„¤ì •</h3>
                <div class="priority-list" id="priorityList">
                    <div class="priority-item" data-interest="ë¬¸í™”/ì˜ˆìˆ ">
                        <div class="priority-number">1</div>
                        <div class="interest-icon">ğŸ­</div>
                        <div class="interest-name">ë¬¸í™”/ì˜ˆìˆ </div>
                        <div class="priority-controls">
                            <button class="priority-btn" onclick="movePriority(this, 'up')">â†‘</button>
                            <button class="priority-btn" onclick="movePriority(this, 'down')">â†“</button>
                        </div>
                    </div>
                    <div class="priority-item" data-interest="ì²´ìœ¡/ìš´ë™">
                        <div class="priority-number">2</div>
                        <div class="interest-icon">ğŸƒâ€â™‚ï¸</div>
                        <div class="interest-name">ì²´ìœ¡/ìš´ë™</div>
                        <div class="priority-controls">
                            <button class="priority-btn" onclick="movePriority(this, 'up')">â†‘</button>
                            <button class="priority-btn" onclick="movePriority(this, 'down')">â†“</button>
                        </div>
                    </div>
                    <div class="priority-item" data-interest="ìŒì‹/ë§›ì§‘">
                        <div class="priority-number">3</div>
                        <div class="interest-icon">ğŸ½ï¸</div>
                        <div class="interest-name">ìŒì‹/ë§›ì§‘</div>
                        <div class="priority-controls">
                            <button class="priority-btn" onclick="movePriority(this, 'up')">â†‘</button>
                            <button class="priority-btn" onclick="movePriority(this, 'down')">â†“</button>
                        </div>
                    </div>
                    <div class="priority-item" data-interest="ì‡¼í•‘/ìƒê¶Œ">
                        <div class="priority-number">4</div>
                        <div class="interest-icon">ğŸ›ï¸</div>
                        <div class="interest-name">ì‡¼í•‘/ìƒê¶Œ</div>
                        <div class="priority-controls">
                            <button class="priority-btn" onclick="movePriority(this, 'up')">â†‘</button>
                            <button class="priority-btn" onclick="movePriority(this, 'down')">â†“</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ì•Œë¦¼ ì„¤ì • -->
            <div class="notification-settings">
                <h3>ê´€ì‹¬ì‚¬ë³„ ì•Œë¦¼ ì„¤ì •</h3>
                <div class="notification-list">
                    <div class="notification-item">
                        <div class="notification-info">
                            <div class="interest-icon">ğŸ­</div>
                            <div class="interest-name">ë¬¸í™”/ì˜ˆìˆ </div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="notification-item">
                        <div class="notification-info">
                            <div class="interest-icon">ğŸƒâ€â™‚ï¸</div>
                            <div class="interest-name">ì²´ìœ¡/ìš´ë™</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="notification-item">
                        <div class="notification-info">
                            <div class="interest-icon">ğŸ½ï¸</div>
                            <div class="interest-name">ìŒì‹/ë§›ì§‘</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="notification-item">
                        <div class="notification-info">
                            <div class="interest-icon">ğŸ›ï¸</div>
                            <div class="interest-name">ì‡¼í•‘/ìƒê¶Œ</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- ì €ì¥ ë²„íŠ¼ -->
            <div class="save-actions">
                <button class="btn-secondary" onclick="goBack()">ì·¨ì†Œ</button>
                <button class="btn-primary" onclick="saveChanges()">ë³€ê²½ì‚¬í•­ ì €ì¥</button>
            </div>
            
            <div class="info-box">
                <h4>ğŸ’¡ ê´€ì‹¬ì‚¬ ì„¤ì • ì•ˆë‚´</h4>
                <ul>
                    <li>ìµœëŒ€ 6ê°œê¹Œì§€ ê´€ì‹¬ì‚¬ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    <li>ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ê´€ì‹¬ì‚¬ì˜ ì†Œì‹ê³¼ í–‰ì‚¬ë¥¼ ë¨¼ì € ë°›ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    <li>ì•Œë¦¼ ì„¤ì •ì„ í†µí•´ ê° ê´€ì‹¬ì‚¬ë³„ë¡œ ì•Œë¦¼ì„ ë°›ì„ì§€ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<style>
    .interests-container {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .current-interests, .add-interests, .priority-settings, .notification-settings {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        margin-bottom: 30px;
    }
    
    .current-interests h3, .add-interests h3, .priority-settings h3, .notification-settings h3 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 1.3em;
        border-bottom: 2px solid #4facfe;
        padding-bottom: 10px;
    }
    
    .current-list, .available-interests {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
    }
    
    .interest-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 15px;
        border-radius: 10px;
        border: 2px solid transparent;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .interest-item.active {
        background: linear-gradient(135deg, #f8f9fa 0%, #e8f4fd 100%);
        border-color: #4facfe;
    }
    
    .interest-item.inactive {
        background: #f8f9fa;
        border-color: #e1e5e9;
    }
    
    .interest-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .interest-icon {
        font-size: 1.5em;
    }
    
    .interest-name {
        flex: 1;
        font-weight: 600;
        color: #2c3e50;
    }
    
    .remove-btn, .add-btn {
        padding: 6px 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.8em;
        transition: all 0.3s ease;
    }
    
    .remove-btn {
        background: #e74c3c;
        color: white;
    }
    
    .add-btn {
        background: #2ecc71;
        color: white;
    }
    
    .remove-btn:hover, .add-btn:hover {
        transform: translateY(-1px);
    }
    
    .priority-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    
    .priority-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
        border-left: 4px solid #4facfe;
    }
    
    .priority-number {
        width: 30px;
        height: 30px;
        background: #4facfe;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 0.9em;
    }
    
    .priority-controls {
        display: flex;
        gap: 5px;
    }
    
    .priority-btn {
        width: 30px;
        height: 30px;
        border: none;
        background: #e1e5e9;
        color: #666;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .priority-btn:hover {
        background: #4facfe;
        color: white;
    }
    
    .notification-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    .notification-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
    }
    
    .notification-info {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    /* í† ê¸€ ìŠ¤ìœ„ì¹˜ ìŠ¤íƒ€ì¼ */
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 24px;
    }
    
    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 24px;
    }
    
    .slider:before {
        position: absolute;
        content: "";
        height: 18px;
        width: 18px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    
    input:checked + .slider {
        background-color: #4facfe;
    }
    
    input:checked + .slider:before {
        transform: translateX(26px);
    }
    
    .save-actions {
        display: flex;
        gap: 15px;
        justify-content: flex-end;
        margin-bottom: 30px;
    }
    
    .btn-primary, .btn-secondary {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 14px;
    }
    
    .btn-primary {
        background: #4facfe;
        color: white;
    }
    
    .btn-primary:hover {
        background: #3a8bfd;
        transform: translateY(-2px);
    }
    
    .btn-secondary {
        background: #95a5a6;
        color: white;
    }
    
    .btn-secondary:hover {
        background: #7f8c8d;
        transform: translateY(-2px);
    }
    
    .info-box {
        background: #e8f4fd;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #4facfe;
    }
    
    .info-box h4 {
        margin-bottom: 10px;
        color: #2c3e50;
        font-size: 1.1em;
    }
    
    .info-box ul {
        margin: 0;
        padding-left: 20px;
        color: #555;
        font-size: 0.9em;
        line-height: 1.6;
    }
    
    .info-box li {
        margin-bottom: 5px;
    }
    
    .alert {
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        font-weight: 600;
    }
    
    .alert-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    
    .alert-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }
</style>

<script>
    // ê´€ì‹¬ì‚¬ ì¶”ê°€
    function addInterest(name, icon) {
        const currentCount = document.querySelectorAll('.interest-item.active').length;
        
        if (currentCount >= 6) {
            alert('ìµœëŒ€ 6ê°œê¹Œì§€ ê´€ì‹¬ì‚¬ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }
        
        // í˜„ì¬ ê´€ì‹¬ì‚¬ ëª©ë¡ì— ì¶”ê°€
        const currentList = document.querySelector('.current-list');
        const newItem = document.createElement('div');
        newItem.className = 'interest-item active';
        newItem.innerHTML = `
            <div class="interest-icon">${icon}</div>
            <div class="interest-name">${name}</div>
            <button class="remove-btn" onclick="removeInterest('${name}')">ì œê±°</button>
        `;
        currentList.appendChild(newItem);
        
        // ìš°ì„ ìˆœìœ„ ëª©ë¡ì— ì¶”ê°€
        const priorityList = document.getElementById('priorityList');
        const priorityItem = document.createElement('div');
        priorityItem.className = 'priority-item';
        priorityItem.dataset.interest = name;
        priorityItem.innerHTML = `
            <div class="priority-number">${currentCount + 1}</div>
            <div class="interest-icon">${icon}</div>
            <div class="interest-name">${name}</div>
            <div class="priority-controls">
                <button class="priority-btn" onclick="movePriority(this, 'up')">â†‘</button>
                <button class="priority-btn" onclick="movePriority(this, 'down')">â†“</button>
            </div>
        `;
        priorityList.appendChild(priorityItem);
        
        // ì•Œë¦¼ ì„¤ì •ì— ì¶”ê°€
        const notificationList = document.querySelector('.notification-list');
        const notificationItem = document.createElement('div');
        notificationItem.className = 'notification-item';
        notificationItem.innerHTML = `
            <div class="notification-info">
                <div class="interest-icon">${icon}</div>
                <div class="interest-name">${name}</div>
            </div>
            <label class="switch">
                <input type="checkbox" checked>
                <span class="slider"></span>
            </label>
        `;
        notificationList.appendChild(notificationItem);
        
        // ì›ë³¸ ì•„ì´í…œ ë¹„í™œì„±í™”
        event.target.closest('.interest-item').classList.remove('inactive');
        event.target.closest('.interest-item').classList.add('active');
        event.target.textContent = 'ì¶”ê°€ë¨';
        event.target.disabled = true;
        
        updatePriorityNumbers();
    }
    
    // ê´€ì‹¬ì‚¬ ì œê±°
    function removeInterest(name) {
        if (confirm(`${name} ê´€ì‹¬ì‚¬ë¥¼ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            // í˜„ì¬ ê´€ì‹¬ì‚¬ ëª©ë¡ì—ì„œ ì œê±°
            const currentItem = event.target.closest('.interest-item');
            currentItem.remove();
            
            // ìš°ì„ ìˆœìœ„ ëª©ë¡ì—ì„œ ì œê±°
            const priorityItem = document.querySelector(`[data-interest="${name}"]`);
            if (priorityItem) {
                priorityItem.remove();
            }
            
            // ì•Œë¦¼ ì„¤ì •ì—ì„œ ì œê±°
            const notificationItems = document.querySelectorAll('.notification-item');
            notificationItems.forEach(item => {
                if (item.querySelector('.interest-name').textContent === name) {
                    item.remove();
                }
            });
            
            // ì‚¬ìš© ê°€ëŠ¥í•œ ê´€ì‹¬ì‚¬ì—ì„œ ë‹¤ì‹œ í™œì„±í™”
            const availableItems = document.querySelectorAll('.available-interests .interest-item');
            availableItems.forEach(item => {
                if (item.querySelector('.interest-name').textContent === name) {
                    item.classList.remove('active');
                    item.classList.add('inactive');
                    const addBtn = item.querySelector('.add-btn');
                    addBtn.textContent = 'ì¶”ê°€';
                    addBtn.disabled = false;
                }
            });
            
            updatePriorityNumbers();
        }
    }
    
    // ìš°ì„ ìˆœìœ„ ì´ë™
    function movePriority(btn, direction) {
        const priorityItem = btn.closest('.priority-item');
        const priorityList = document.getElementById('priorityList');
        
        if (direction === 'up' && priorityItem.previousElementSibling) {
            priorityList.insertBefore(priorityItem, priorityItem.previousElementSibling);
        } else if (direction === 'down' && priorityItem.nextElementSibling) {
            priorityList.insertBefore(priorityItem.nextElementSibling, priorityItem);
        }
        
        updatePriorityNumbers();
    }
    
    // ìš°ì„ ìˆœìœ„ ë²ˆí˜¸ ì—…ë°ì´íŠ¸
    function updatePriorityNumbers() {
        const priorityItems = document.querySelectorAll('.priority-item');
        priorityItems.forEach((item, index) => {
            item.querySelector('.priority-number').textContent = index + 1;
        });
    }
    
    // ë³€ê²½ì‚¬í•­ ì €ì¥
    function saveChanges() {
        // ì‹¤ì œ API í˜¸ì¶œ ëŒ€ì‹  ì‹œë®¬ë ˆì´ì…˜
        showAlert('ê´€ì‹¬ì‚¬ ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        
        setTimeout(() => {
            window.location.href = '/board/myinterests/';
        }, 2000);
    }
    
    // ì•Œë¦¼ í‘œì‹œ
    function showAlert(message, type) {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type}`;
        alertDiv.textContent = message;
        
        const container = document.querySelector('.interests-container');
        container.insertBefore(alertDiv, container.firstChild);
        
        setTimeout(() => {
            alertDiv.remove();
        }, 5000);
    }
    
    // ë’¤ë¡œ ê°€ê¸°
    function goBack() {
        window.history.back();
    }
</script>
{% endblock %}
